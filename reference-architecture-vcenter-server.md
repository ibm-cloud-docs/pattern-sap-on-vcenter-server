---

copyright:
  years: 2024
lastupdated: "2024-02-01"

subcollection: pattern-sap-on-vcenter-server

keywords:

authors:
  - name: Doug Eppard

version: 1.0

deployment-url:

docs: /docs/pattern-sap-on-vcenter-server

content-type: reference-architecture

---

{{site.data.keyword.attribute-definition-list}}

# SAP on VMware Cloud Foundation (VCF) for Classic
{: #sap-on-vcenter-server}
{: toc-content-type="reference-architecture"}
{: toc-version="1.0"}

This is a baseline solution pattern containing the design and architecture decisions for an SAP deployment to VMware Cloud Foundation (VCF) for Classic on {{site.data.keyword.Bluemix_notm}} to meet common requirements. Actual client solutions depend on the specific requirements that are set by the client.

## Architecture diagram
{: #architecture-diagram}

Figure 1 illustrates a network and component architecture for a single-zone, multi-region deployment to facilitate disaster recovery (DR).

A recommended approach for optimization of the DR environment is to run selected nonproduction environments on DR infrastructure. In the case of a disaster declaration, the nonproduction environment can be repurposed for DR. This is applicable for only the application layer because the DR database should be constantly replicated from production.

* The primary region supports production workloads on VMware running SAP Certified {{site.data.keyword.baremetal_short_sing}} ESXi hosts.

* The secondary region supports nonproduction and DR workloads if the customer has DR requirements.

![A screenshot of a computer Description automatically generated](./sap-on-vmware-architecture.svg){: caption="Figure 1: SAP on {{site.data.keyword.Bluemix_notm}} VMware® vCenter Server® Architecture" caption-side="bottom"}

## Understanding the architecture diagram
{: #architecture-diagram-description}

The diagram illustrates a high level architecture and the numbered items on the diagram correspond to the following descriptions:

1.  Two separate {{site.data.keyword.Bluemix_notm}} regions, one containing production and the other containing both nonproduction and DR
2.  Client network connectivity is accomplished by using {{site.data.keyword.dl_short}} to each region
3.  Site to site VPN access for managed service providers
4.  Public connectivity routes through {{site.data.keyword.cis_full_notm}} {{site.data.keyword.Bluemix_notm}} Internet Services (CIS) which can provide load balancing, failover, and Distributed Denial-of-Service(DDoS) services
5.  {{site.data.keyword.vsrx_full}} firewall to provide underlay network routing and security services
6.  NSX-T™ (tier-0 and tier-1) to provide VMware overlay network routing and isolation.
7.  Management network to provide VMware management and automation
8.  {{site.data.keyword.baremetal_short_sing}} VMware ESXi hosts
9.  Veeam backup server {{site.data.keyword.baremetal_short_sing}}
10. High performance endurance storage for VMware environment
11. {{site.data.keyword.cos_full_notm}} for long term backups
12. Bastion host for administrative access and privileged access management

For VMware specific architecture patterns, see [Architecture pattern for single site vCenter Server deployment topologies](/docs/vmwaresolutions?topic=vmwaresolutions-arch-pattern-deployment-single-site).

## Design scope considerations
{: #design-scope}

Design decisions that need to be considered for an end to end deployment of SAP on VMware on {{site.data.keyword.Bluemix_notm}} include:

-   **Compute:** {{site.data.keyword.baremetal_short}} and Virtual infrastructure
-   **Storage:** Primary, Backup and Archive
-   **Networking:** Enterprise Connectivity, Edge Gateways, Segmentation and Isolation, Cloud Native Connectivity and Load Balancing
-   **Security:** Data, Identity and Access Management, Infrastructure and Endpoint, Threat Detection and Response
-   **Resiliency:** Backup and Restore, Disaster Recovery, High Availability
-   **Service Management:** Monitoring, Logging, Alerting, Management and Orchestration


The [Architecture framework](/docs/architecture-framework?topic=architecture-framework-intro) provides a consistent approach to design cloud solutions by addressing requirements across a predefined set of aspects and domains. Aspects and domains are architectural areas that need to be considered for any enterprise solution. It can be used as a guide to make the necessary design and component choices to ensure you have considered applicable requirements for each aspect and domain. After you have identified the applicable requirements and domains that are in scope, you can evaluate and select the best “fit for purpose” components for your enterprise cloud solution.

Figure 2 is an architecture Heatmap for SAP on {{site.data.keyword.Bluemix_notm}} VMware Cloud Foundation (VCF) for Classic that illustrates the domains that are covered in this solution by using the architecture framework.

![A screenshot of a computer Description automatically generated](./sap-on-vmware-heatmap.svg){: caption="Figure 2: Domains covered in this pattern" caption-side="bottom"}

## Requirements
{: #architecture-requirements}

The following represents a baseline set of requirements that are applicable to most clients and critical to successful SAP deployment.

| Aspect         | Requirement|
|---|---|
| Network            | Enterprise connectivity to customer data centers to provide access to on-premise applications                                                                                                                                                                                                                                            |
|                    | Map and convert customer SAP network functionality into VMware on {{site.data.keyword.Bluemix_notm}} networking services                                                                                                                                                                                                                                         |
|                    | Migrate and redeploy customer IP addressing scheme within the VMware on {{site.data.keyword.Bluemix_notm}} environment                                                                                                                                                                                                                                               |
|                    | Provide network isolation with the ability to segregate applications based on attributes such as data classification, public versus internal apps, and function                                                                                                                                                                             |
| Security           | Provide data encryption in transit and at rest                                                                                                                                                                                                                                                                                          |
|                    | Migrate customer Intrusion Detection System(IDS) and Identity and Access Management(IAM) services to target VMware on {{site.data.keyword.Bluemix_notm}}                                                                                                                                                                                                           |
|                    | Retain the same firewall rulesets across existing datacenters                                                                                                                                                                                                                                                                           |
|                    | Firewalls must be restrictively configured to provide advanced security features and prevent all traffic, both inbound and outbound, except that which is specifically required, documented, and approved and include Intrusion Prevention System (IPS) and Intrusion Detection System (IDS)                                        |
| Resiliency         | Multi-site capability to support a disaster recovery strategy and solution leveraging {{site.data.keyword.Bluemix_notm}} infrastructure disaster recovery capabilities                                                                                                                                                                                                          |
|                    | Provide backups for data retention                                                                                                                                                                                                                                                                                                      |
|                    | Recovery Time Objective(RTO) and Recovery Point Objective(/RPO) = 4 hours/15 minutes. Rollback to original environments should occur no later than specified RTOs                                                                                                                                                                            |
|                    | 99.9% Availability                                                                                                                                                                                                                                                                                                                      |
|                    | Backups production: Daily full, logs per SAP product standard  \n 30 days retention time nonproduction: Weekly full, logs per SAP product standard, 14 days retention time                                                                                                                                                                |
| Service Management | Provide health and system monitoring with ability to monitor and correlate performance metrics and events and provide alerting across applications and infrastructure                                                                                                                                                                   |
|                    | Ability to diagnose issues and exceptions and identify error sources                                                                                                                                                                                                                                                                    |
|                    | Automate management processes to keep applications and infrastructure secure, up to date, and available                                                                                                                                                                                                                                 |
| Other              | Migrate SAP workloads from existing data center to VMware on {{site.data.keyword.Bluemix_notm}}                                                                                                                                                                                                                                                                  |
|                    | Customer’s SAP systems and applications run on NetWeaver & SAP HANA, AnyDB or S/4HANA                                                                                                                                                                                                                           |
|                    | Provide an image replication migration solution that minimizes disruption during cut-over                                                                                                                                                                                                                                           |
|                    | Cloud infrastructure for the proposed Infrastructure as a Service (IaaS) solution must be SAP Certified                                                                                                                                                                                                                              |
|                    | {{site.data.keyword.Bluemix_notm}} IaaS will be deployed to support SAP and surrounding non-SAP workloads                                                                                                                                                                                                                                                        |
|                    | A customer that doesn't want to adopt [RISE](https://www.ibm.com/consulting/rise-with-sap?utm_content=SRCWW&p1=Search&p4=43700077624079785&p5=e&gclid=EAIaIQobChMIr9bRlt7LgQMVJdHCBB0cewwcEAAYASAAEgIVgfD_BwE&gclsrc=aw.ds){: external} at this time but wants to consider a cloud deployment solution that would facilitate a future RISE transformation |
{: caption="Table 1. Requirements" caption-side="bottom"}

## Components
{: #architecture-components}

Table 2 contains a list of {{site.data.keyword.Bluemix_notm}} components used in the solution. It is supported by the architecture considerations and architecture decisions that are included in the pattern document set.


| Category| Solution components|How it is used in a solution|
|---|---|---|
| Database                           | HANA or AnyDB (Db2, Oracle, MSSQL)| Database for SAP application portfolio                                                                                                                |
| Compute                            | [VMware® vCenter Server®](/docs/vmwaresolutions?topic=vmwaresolutions-vc_vcenterserveroverview)                                                                                                                                                                                                                                                                                                                                                                                                                                        | NetWeaver and SAP HANA DB                                                                                                                             |
| Storage                            | [Network File Storage(NFS)](/docs/vmwaresolutions?topic=vmwaresolutions-vc_orderinginstance-consold-cluster#vc_orderinginstance-nfs-storage)                                                                                                                                                                                                                                                                                                                                                                                            | ESXi host servers primary storage for NetWeaver and SAP HANA DB, or AnyDB                                                                             |
|                                    | [{{site.data.keyword.cos_full_notm}}](/docs/cloud-object-storage?topic=cloud-object-storage-about-cloud-object-storage)                                                                                                                                                                                                                                                                                                                                                                                                                  | Backup and archive, application logs, operational logs, and audit logs                                                                                 |
| Networking                         | Site to site VPN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Remote access to manage resources in a private network                                                                                                  |
|                                    | [{{site.data.keyword.dl_short}} Connect](/docs/dl?topic=dl-get-started-with-ibm-cloud-dl#get-started-with-direct-link-connect)                                                                                                                                                                                                                                                                                                                                                                                                               | Enterprise to cloud network connectivity                                                                                                              |
|                                    | [{{site.data.keyword.vsrx_full}}](/docs/vmwaresolutions?topic=vmwaresolutions-juniper-overview) with content security bundle (CSB)                                                                                                                                                                                                                                                                                                                                                                                                 | Edge gateway and security services                                                                                                                    |
|                                    | [Service Endpoints](/docs/account?topic=account-vrf-service-endpoint&interface=ui#use-service-endpoint)                                                                                                                                                                                                                                                                                                                                                                                                                   | Private network access to cloud services, for example, Key Protect, Cloud Object Storage, and so on.                                                                                 |
|                                    | [NSX-T™ Load Balancer](https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-F0C4A33A-2B1F-43AA-94E1-602B628AFD52.html)                                                                                                                                                                                                                                                                                                                                                                                                                 | Application load balancing for web servers, app servers, and database servers                                                                         |
|                                    | [{{site.data.keyword.cis_full_notm}}](/docs/cis?topic=cis-getting-started) (CIS)                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Public load balancing and DDoS                                                                                                                        |
|                                    | [{{site.data.keyword.dns_full_notm}}](/docs/dns-svcs?topic=dns-svcs-about-dns-services)                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  Domain name resolution                                                                                                                               |
|                                    | [NSX-T™/VLANs](/docs/vmwaresolutions?topic=vmwaresolutions-arch-pattern-overlays-single-site)                                                                                                                                                                                                                                                                                                                                                                                                                              | Network segmentation and isolation                                                                                                                    |
|                                    | [{{site.data.keyword.tg_full_notm}}](/docs/transit-gateway?topic=transit-gateway-about)                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Provides {{site.data.keyword.dl_short}} connectivity and GRE tunnel endpoint for bring your own IP (BYOIP) scenarios                                                     |
|                                    | SAP Web Dispatcher \n [NSX-T™ Load balancer](https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-F0C4A33A-2B1F-43AA-94E1-602B628AFD52.html)                                                                                                                                                                                                                                                                                                                                                                                              | Load balancing workloads across multiple workload instances over the private network                                                                  |
| Security                           | [Endurance NFS Storage with VMware vSphere encryption](/docs/vmwaresolutions?topic=vmwaresolutions-vc_orderinginstance-consold-cluster#vc_orderinginstance-nfs-storage)                                                                                                                                                                                                                                                                                                                                                                                                        | Network File Storage encryption at rest                                                                                                               |
|                                    | {{site.data.keyword.cos_full_notm}} Encryption with provider keys                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Cloud Object Storage encryption at rest                                                                                                               |
|                                    | SAP HANA Data Volume Encryption (DVE)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | SAP HANA database encryption at rest                                                                                                                  |
|                                    | [{{site.data.keyword.iamlong}}](/docs/account?topic=account-cloudaccess)                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | {{site.data.keyword.Bluemix_notm}} Identity and Access Management                                                                                                                |
|                                    | Privileged Identity and Access Management                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Bring your own bastion jump server (or Privileged Access Gateway) with privileged access management (PAM) software that is deployed in on isolated VXLan         |
|                                    | BYO bastion jump server on virtual server instance (VSI) with privileged access management software                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Remote access with privileged access management                                                                                                       |
|                                    | [{{site.data.keyword.vsrx_full}}](/docs/vmwaresolutions?topic=vmwaresolutions-juniper-overview) with content security bundle (CSB)                                                                                                                                                                                                                                                                                                                                                                                                 | Core network protection Intrusion Protection System and Intrusion Detection System at all ingress/egress Unified Threat Management (UTM) Firewall |
|                                    | [{{site.data.keyword.cis_full_notm}}](/docs/cis?topic=cis-getting-started) (CIS)                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | DDoS protection and Web Application Firewall (WAF)                                                                                                                  |
| Resiliency                         | SAP HANA System Replication (HSR)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Provide 99.95% availability for SAP HANA DB                                                                                                           |
|                                    | [Veeam Software (Veeam)](/docs/vmwaresolutions?topic=vmwaresolutions-veeamvm_overview)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Controls both the backups and restores of all VSIs or {{site.data.keyword.baremetal_short}}                                                                                     |
|                                    | High Availability Infrastructure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | High availability solution on a single zone with an application SLA of 99.9% with vMotion enabled                                                     |
| Service Management (Observability) | [{{site.data.keyword.monitoringlong_notm}}](/docs/monitoring?topic=monitoring-about-monitor) \n [VMware Aria Operations](/docs/vmwaresolutions?topic=vmwaresolutions-vrw-operations#vrw-operations-management-vrops) \n [VMware Aria Operations for Logs](/docs/vmwaresolutions?topic=vmwaresolutions-vrw-operations#vrw-operations-management-vrli) \n [VMware Aria Operations for Networks](/docs/vmwaresolutions?topic=vmwaresolutions-vrw-operations#vrw-operations-management-vrni) | Application and operational monitoring                                                                                                                       |
|                                    | [{{site.data.keyword.loganalysislong_notm}}](/docs/log-analysis?topic=log-analysis-getting-started)                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Application and operational logs                                                                                                                             |
{: caption="Table 2. Components" caption-side="bottom"}

The following sections in this guide contain the considerations and architecture decisions for the aspects and domains that are in play in this solution pattern.
